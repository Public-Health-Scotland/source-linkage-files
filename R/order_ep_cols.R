#' Order SLF Episode File Columns
#'
#' Reorders an SLF episode file dataframe so that its columns appear
#' in the standard schema order used by the `createslf` package.
#'
#' This ensures a consistent column structure across all years of data.
#'
#' @param episode_file A dataframe representing the SLF episode file.
#'   Must contain the expected variables; any extra columns will be dropped.
#'
#' @return The input dataframe with its columns reordered into the
#'   standard SLF episode file order.
#'
#' @details
#' New variables added to SLFs should also be added here to maintain
#' consistency across years.
#'
#' @family createslf schema functions
#'
#' @examples
#' \dontrun{
#' df <- read.csv("my_episode_file.csv")
#' df_ordered <- order_ep_cols(df)
#' }
#'
#' @export
order_ep_cols <- function(episode_file) {
  episode_file <- episode_file %>%
    # Format the keytime1 and keytime2 as hms
    dplyr::mutate(
      keytime1 = hms::as_hms(as.character(keytime1)),
      keytime2 = hms::as_hms(as.character(keytime2))
    ) %>%
    # Ordering the columns
    dplyr::select(c(
      "year",
      "recid",
      "record_keydate1",
      "record_keydate2",
      "keytime1",
      "keytime2",
      "smrtype",
      "anon_chi",
      "gender",
      "dob",
      "age",
      "deceased",
      "death_date",
      "activity_after_death",
      "gpprac",
      "postcode",
      "hbrescode",
      "location",
      "hbtreatcode",
      "hbpraccode",
      "lca",
      "locality",
      "datazone2011",
      "datazone2022",
      "hb2019",
      "hscp2019",
      "hscp2018",
      "ca2019",
      "ca2018",
      "simd2020v2_rank",
      "simd2020v2_sc_decile",
      "simd2020v2_sc_quintile",
      "simd2020v2_hb2019_decile",
      "simd2020v2_hb2019_quintile",
      "simd2020v2_hscp2019_decile",
      "simd2020v2_hscp2019_quintile",
      "ur8_2022",
      "ur6_2022",
      "ur3_2022",
      "ur2_2022",
      "cluster",
      "demographic_cohort",
      "service_use_cohort",
      "ipdc",
      "spec",
      "sigfac",
      "cup_pathway",
      "cup_marker",
      "cij_marker",
      "cij_start_date",
      "cij_end_date",
      "cij_pattype_code",
      "cij_ipdc",
      "cij_admtype",
      "cij_adm_spec",
      "cij_dis_spec",
      "cij_pattype",
      "cij_ppa",
      "cij_delay",
      "smr01_cis_marker",
      "diag1",
      "diag2",
      "diag3",
      "diag4",
      "diag5",
      "diag6",
      "deathdiag1",
      "deathdiag2",
      "deathdiag3",
      "deathdiag4",
      "deathdiag5",
      "deathdiag6",
      "deathdiag7",
      "deathdiag8",
      "deathdiag9",
      "deathdiag10",
      "deathdiag11",
      "death_location_code",
      "post_mortem",
      "place_death_occurred",
      "death_board_occurrence",
      "arth_date",
      "asthma_date",
      "atrialfib_date",
      "cancer_date",
      "cvd_date",
      "liver_date",
      "copd_date",
      "dementia_date",
      "diabetes_date",
      "epilepsy_date",
      "chd_date",
      "hefailure_date",
      "ms_date",
      "parkinsons_date",
      "refailure_date",
      "congen_date",
      "bloodbfo_date",
      "endomet_date",
      "digestive_date",
      "arth",
      "asthma",
      "atrialfib",
      "cancer",
      "cvd",
      "liver",
      "copd",
      "dementia",
      "diabetes",
      "epilepsy",
      "chd",
      "hefailure",
      "ms",
      "parkinsons",
      "refailure",
      "congen",
      "bloodbfo",
      "endomet",
      "digestive",
      "attendance_status",
      "stay",
      "conc",
      "mpat",
      "cat",
      "tadm",
      "adtf",
      "admloc",
      "oldtadm",
      "disch",
      "dischto",
      "dischloc",
      "discondition",
      "nhshosp",
      "stadm",
      "adcon1",
      "adcon2",
      "adcon3",
      "adcon4",
      "reftype",
      "commhosp",
      "uri",
      "op1a",
      "op1b",
      "dateop1",
      "op2a",
      "op2b",
      "dateop2",
      "op3a",
      "op3b",
      "dateop3",
      "op4a",
      "op4b",
      "dateop4",
      "clinic_type",
      "no_paid_items",
      "yearstay",
      "jan_beddays",
      "feb_beddays",
      "mar_beddays",
      "apr_beddays",
      "may_beddays",
      "jun_beddays",
      "jul_beddays",
      "aug_beddays",
      "sep_beddays",
      "oct_beddays",
      "nov_beddays",
      "dec_beddays",
      "cost_total_net",
      "cost_total_net_inc_dnas",
      "jan_cost",
      "feb_cost",
      "mar_cost",
      "apr_cost",
      "may_cost",
      "jun_cost",
      "jul_cost",
      "aug_cost",
      "sep_cost",
      "oct_cost",
      "nov_cost",
      "dec_cost",
      "social_care_id",
      "person_id",
      "sc_living_alone",
      "sc_support_from_unpaid_carer",
      "sc_social_worker",
      "sc_type_of_housing",
      "sc_meals",
      "sc_day_care",
      "sc_dementia",
      "sc_learning_disability",
      "sc_mental_health_disorders",
      "sc_physical_and_sensory_disability",
      "sc_drugs",
      "sc_alcohol",
      "sc_palliative_care",
      "sc_carer",
      "sc_elderly_frail",
      "sc_neurological_condition",
      "sc_autism",
      "sc_other_vulnerable_groups",
      "sc_ch_link_ae",
      "sc_ch_link_adms",
      "sc_send_lca",
      "sc_latest_submission",
      "ch_name",
      "ch_postcode",
      "ch_chi_cis",
      "ch_sc_id_cis",
      "ch_provider",
      "ch_provider_description",
      "ch_nursing",
      "ch_adm_reason",
      "dd_responsible_lca",
      "delay_end_reason",
      "primary_delay_reason",
      "secondary_delay_reason",
      "dd_quality",
      "ae_arrivalmode",
      "refsource",
      "ae_attendcat",
      "ae_disdest",
      "ae_patflow",
      "ae_placeinc",
      "ae_reasonwait",
      "ae_bodyloc",
      "ae_alcohol",
      "alcohol_adm",
      "submis_adm",
      "falls_adm",
      "selfharm_adm",
      "sparra_start_fy",
      "sparra_end_fy",
      "hhg_start_fy",
      "hhg_end_fy",
      "ccm",
      "total_no_dn_contacts",
      "kis_accessed",
      "ooh_outcome1",
      "ooh_outcome2",
      "ooh_outcome3",
      "ooh_outcome4",
      "ooh_case_id",
      "hc_hours_q1",
      "hc_hours_q2",
      "hc_hours_q3",
      "hc_hours_q4",
      "hc_hours_annual",
      "hc_cost_q1",
      "hc_cost_q2",
      "hc_cost_q3",
      "hc_cost_q4",
      "hc_provider",
      "hc_reablement",
      "hl1_application_ref",
      "hl1_sending_lca",
      "hl1_property_type",
      "hl1_reason_ftm",
      "hl1_completeness",
      "hl1_in_fy",
      "hl1_6before_ep",
      "hl1_6after_ep",
      "hl1_during_ep",
      "hl1_12_months_pre_app",
      "hl1_12_months_post_app"
    ))
  return(episode_file)
}
